/**
* XMLHttpRequest.js Copyright (C) 2011 Sergey Ilinsky (http://www.ilinsky.com)
*/
(function(){function o(){this._object=h&&!q?new h:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function a(){return new o}function l(e){a.onreadystatechange&&a.onreadystatechange.apply(e);e.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function p(a){try{a.responseText=a._object.responseText}catch(c){}try{var d;var g=a._object,b=g.responseXML,i=g.responseText;j&&(i&&b&&!b.documentElement&&g.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/))&&
(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.validateOnParse=!1,b.loadXML(i));d=b&&(j&&0!==b.parseError||!b.documentElement||b.documentElement&&"parsererror"==b.documentElement.tagName)?null:b;a.responseXML=d}catch(f){}try{a.status=a._object.status}catch(h){}try{a.statusText=a._object.statusText}catch(k){}}function m(a){a._object.onreadystatechange=new window.Function}var h=window.XMLHttpRequest,n=!!window.controllers,j=window.document.all&&!window.opera,q=j&&window.navigator.userAgent.match(/MSIE 7.0/);
a.prototype=o.prototype;n&&h.wrapped&&(a.wrapped=h.wrapped);a.UNSENT=0;a.OPENED=1;a.HEADERS_RECEIVED=2;a.LOADING=3;a.DONE=4;a.prototype.UNSENT=a.UNSENT;a.prototype.OPENED=a.OPENED;a.prototype.HEADERS_RECEIVED=a.HEADERS_RECEIVED;a.prototype.LOADING=a.LOADING;a.prototype.DONE=a.DONE;a.prototype.readyState=a.UNSENT;a.prototype.responseText="";a.prototype.responseXML=null;a.prototype.status=0;a.prototype.statusText="";a.prototype.priority="NORMAL";a.prototype.onreadystatechange=null;a.onreadystatechange=
null;a.onopen=null;a.onsend=null;a.onabort=null;a.prototype.open=function(e,c,d,g,b){var i=e.toLowerCase();if(i=="connect"||i=="trace"||i=="track")throw Error(18);delete this._headers;arguments.length<3&&(d=true);this._async=d;var f=this,h=this.readyState,k=null;if(j&&d){k=function(){if(h!=a.DONE){m(f);f.abort()}};window.attachEvent("onunload",k)}a.onopen&&a.onopen.apply(this,arguments);arguments.length>4?this._object.open(e,c,d,g,b):arguments.length>3?this._object.open(e,c,d,g):this._object.open(e,
c,d);this.readyState=a.OPENED;l(this);this._object.onreadystatechange=function(){if(!n||d){f.readyState=f._object.readyState;p(f);if(f._aborted)f.readyState=a.UNSENT;else if(f.readyState==a.DONE){delete f._data;m(f);j&&d&&window.detachEvent("onunload",k);h!=f.readyState&&l(f);h=f.readyState}}}};a.prototype.send=function(e){a.onsend&&a.onsend.apply(this,arguments);arguments.length||(e=null);if(e&&e.nodeType){e=window.XMLSerializer?(new window.XMLSerializer).serializeToString(e):e.xml;this._headers["Content-Type"]||
this._object.setRequestHeader("Content-Type","application/xml")}this._data=e;a:{this._object.send(this._data);if(n&&!this._async){this.readyState=a.OPENED;for(p(this);this.readyState<a.DONE;){this.readyState++;l(this);if(this._aborted)break a}}}};a.prototype.abort=function(){a.onabort&&a.onabort.apply(this,arguments);if(this.readyState>a.UNSENT)this._aborted=true;this._object.abort();m(this);this.readyState=a.UNSENT;delete this._data};a.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};
a.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)};a.prototype.setRequestHeader=function(a,c){if(!this._headers)this._headers={};this._headers[a]=c;return this._object.setRequestHeader(a,c)};a.prototype.addEventListener=function(a,c,d){for(var g=0,b;b=this._listeners[g];g++)if(b[0]==a&&b[1]==c&&b[2]==d)return;this._listeners.push([a,c,d])};a.prototype.removeEventListener=function(a,c,d){for(var g=0,b;b=this._listeners[g];g++)if(b[0]==a&&b[1]==c&&b[2]==d)break;b&&this._listeners.splice(g,
1)};a.prototype.dispatchEvent=function(a){a={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};a.type=="readystatechange"&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[a]);for(var c=0,d;d=this._listeners[c];c++)d[0]==a.type&&!d[2]&&(d[1].handleEvent||d[1]).apply(this,[a])};a.prototype.toString=
function(){return"[object XMLHttpRequest]"};a.toString=function(){return"[XMLHttpRequest]"};window.Function.prototype.apply||(window.Function.prototype.apply=function(a,c){c||(c=[]);a.__func=this;a.__func(c[0],c[1],c[2],c[3],c[4]);delete a.__func});window.XMLHttpRequest=a})();